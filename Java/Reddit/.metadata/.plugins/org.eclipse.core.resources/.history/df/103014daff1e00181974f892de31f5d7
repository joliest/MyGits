package com.miforum.database;

import java.sql.*;

import com.miforum.components.Component;

public abstract class Database {
	
	protected Connection connection = null;
	protected Statement statement = null;
	protected PreparedStatement preparedStatement = null;
	protected ResultSet resultSet = null;
	
	public Database() {		 
		try {
			Class.forName("oracle.jdbc.driver.OracleDriver");
			connection = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "System", "Sql12345");
		} catch (Exception exception) {
			System.out.println(exception);
		}
	}
	
	public abstract void insert(Component component);
	public abstract String select(Component component);
	public abstract void delete(Component component);
	public abstract void update(Component oldComponent, Component newComponent);
	
	protected ResultSet statement(Statement statement, String sqlQuery) {
		try {
			
			if(statement instanceof PreparedStatement) {
				PreparedStatement stmt = (PreparedStatement) statement;
				stmt.execute();
			} else {
				ResultSet rs = statement.executeQuery(sqlQuery);
				rs.next();
				return rs;
			}			
			
		} catch(SQLException ex) {
			System.out.println(ex);
		} finally {
			try {
				if (statement != null) {
					statement.close();
				}
				if (preparedStatement != null) {
					preparedStatement.close();
				}
				if (connection != null) {
					connection.close();
				}
			} catch (SQLException ex) {
				System.out.println(ex);
			}		
			
			}
		return null;
	}

	protected void statement(Statement statement) throws SQLException{
		statement(statement, null);
	}
	
}
